(function(){"use strict";var t=function t(){var t,e,n="";for(t=0;32>t;t++)e=0|16*Math.random(),(8===t||12===t||16===t||20===t)&&(n+="-"),n+=(12===t?4:16===t?8|3&e:e).toString(16);return n},e=function e(t){var e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),i=t-3600*e-60*n;return 10>e&&(e="0"+e),10>n&&(n="0"+n),10>i&&(i="0"+i),e+":"+n+":"+i},n=function n(){var t=0,e=null,n=new Audio("media/beep.ogg");n.loop=!0,this.startAlarm=function(){t++,2>t&&(n.play(),navigator.vibrate&&r())},this.stopAlarm=function(){t>0&&t--,0===t&&(n.pause(),n.currentTime=0,navigator.vibrate&&a())};var i=function i(){navigator.vibrate(200)},a=function a(){window.clearInterval(e),navigator.vibrate(0)},r=function r(){e=window.setInterval(i,1e3)}},i=function i(t,n,i){this.time=0,this.status="off",this.elDisplay=t,this.elButton=n,this.alarm=i;var a=null,r=this;this.start=function(t){l(t),r.status="ticking",r.alarm.stopAlarm(),u()},this.stop=function(){o(),r.status="off",u()},this.dismissAlarm=function(){"alarm"===r.status&&(r.status="off",u())};var s=function s(){r.time--,0===r.time&&(o(),r.status="alarm"),u()},l=function l(t){r.time=t,a=window.setInterval(s,1e3)},o=function o(){r.time=0,window.clearInterval(a)},u=function u(){switch(r.elDisplay.textContent=e(r.time),r.status){case"ticking":r.elButton.innerHTML="Stop",r.elDisplay.classList.remove("finished");break;case"alarm":r.elButton.innerHTML="Start",r.elDisplay.classList.add("finished"),r.alarm.startAlarm();break;case"off":r.elButton.innerHTML="Start",r.elDisplay.classList.remove("finished"),r.alarm.stopAlarm();break;default:alert("Something went wrong")}}},a=function a(e,n){this.id=t(),this.duration=e,this.description=n};document.onreadystatechange=function(){if("interactive"===document.readyState){var t=[],r=0,s=new n,l=document.getElementById("hplus"),o=document.getElementById("hminus"),u=document.getElementById("hours"),c=document.getElementById("mplus"),d=document.getElementById("mminus"),m=document.getElementById("mins"),v=document.getElementById("splus"),f=document.getElementById("sminus"),g=document.getElementById("secs"),p=document.getElementById("btn1"),E=document.getElementById("btn2"),h=document.getElementById("btn3"),I=document.getElementById("timer1"),y=document.getElementById("timer2"),L=document.getElementById("timer3"),B=document.getElementById("sidepanelbtn"),b=document.getElementById("addpreset"),k=new i(I,p,s),S=new i(y,E,s),w=new i(L,h,s);p.timer=I.timer=k,E.timer=y.timer=S,h.timer=L.timer=w;var N=function N(){return 3600*Number(u.value)+60*Number(m.value)+Number(g.value)},M=function M(t){var e=Number(t),n=0,i=0,a=0;n=Math.floor(e/3600),i=Math.floor((e-3600*n)/60),a=e-3600*n-60*i,u.value=n,m.value=i,g.value=a},A=function A(){document.getElementById("center-panel").classList.toggle("sidepanel-enabled")},D=function D(){document.getElementById("presets").innerHTML="",t.forEach(function(t){var n=e(t.duration),i=t.description,a='<div class="description">'+i+'</div><div class="duration">'+n+"</div>",r=document.createElement("li");r.dataset.id=t.id,r.innerHTML=a,r.addEventListener("click",z,!1),document.getElementById("presets").appendChild(r)})},T=function T(){var t=Number(u.value)+1;u.value=t>23?0:t},H=function H(){var t=Number(u.value)-1;u.value=0>t?23:t},P=function P(){var t=Number(m.value)+1;m.value=t>59?0:t},J=function J(){var t=Number(m.value)-1;m.value=0>t?59:t},O=function O(){var t=Number(g.value)+1;g.value=t>59?0:t},C=function C(){var t=Number(g.value)-1;g.value=0>t?59:t},x=function x(){this.value.length>2&&(this.value=this.value.slice(0,2))},Y=function Y(t){var e=t.target.timer;"ticking"===e.status?e.stop():N()?(e.start(N()),r=N(),Q()):alert("Select time first")},j=function j(t){var e=t.target.timer;e.dismissAlarm()},q=function(t){t.preventDefault(),t.stopPropagation(),A()},z=function z(e){e.preventDefault(),e.stopPropagation();var n=e.currentTarget.dataset.id;t.forEach(function(t){t.id===n&&(M(t.duration),A())})},F=function F(e){e.preventDefault(),e.stopPropagation();var n=N();if(n){var i=prompt("Preset description"),r=i.trim();if(r){var s=new a(n,r);t.push(s),G(),D()}else alert("You must enter a description first.")}else alert("Enter duration first.")};l.addEventListener("click",T,!1),o.addEventListener("click",H,!1),c.addEventListener("click",P,!1),d.addEventListener("click",J,!1),v.addEventListener("click",O,!1),f.addEventListener("click",C,!1),p.addEventListener("click",Y,!1),E.addEventListener("click",Y,!1),h.addEventListener("click",Y,!1),I.addEventListener("click",j,!1),y.addEventListener("click",j,!1),L.addEventListener("click",j,!1),u.addEventListener("input",x,!1),m.addEventListener("input",x,!1),g.addEventListener("input",x,!1),B.addEventListener("click",q,!1),b.addEventListener("click",F,!1);var G=function G(){localStorage.setItem("presets",JSON.stringify(t))},K=function K(){localStorage.getItem("presets")||localStorage.setItem("presets",JSON.stringify([])),t=JSON.parse(localStorage.getItem("presets"))},Q=function Q(){r=localStorage.setItem("last",r)},R=function R(){localStorage.getItem("last")||localStorage.setItem("last",0),r=localStorage.getItem("last")};R(),M(r),K(),D()}}})();